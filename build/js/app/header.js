define(["jquery","TweenMax","signals"],function(a,b,c){var d="--",e={},f=313,g=50,h=!1,i=!1,j=0;e.on={initialized:new c.Signal,open:new c.Signal,close:new c.Signal,toggleRenderer:new c.Signal},e.init=function(){for(var c=a(".buttonSubMenu"),d=0;d<c.length;d++){var g=a(c[d]);g.attr("folio-id")&&a(g).css("background-image","url('images/menus/"+g.attr("folio-id")+".jpg')")}a(".button-menu, .button-contact").on("click",function(b){b.preventDefault(),controlMenuState(a(this).attr("id"),.3)}),a(".toggle-renderer").on("click",function(a){a.preventDefault(),e.on.toggleRenderer.dispatch()}),a(".closeMenuPicto").on("click",function(a){a.preventDefault(),e.close()}),a(".contactPanel .share .content").mouseover(function(){r("share",.3)}),a(".contactPanel .contact").mouseover(function(){r("contact",.3)}),a("#submit_btn").on("click",v),a("a.email").on("click",k),b.set(a(".menu3D"),{height:f,y:-f,autoAlpha:1}),controlMenuState("",0),e.resize(),e.on.initialized.dispatch()};var k=function(){UTILS.linkTo_UnCryptMailto("nbjmup;jogpAuvscpesjwf/uw")};e.isOpen=function(){return i},e.show=function(c){b.to(a(".navbar-default"),.5,{autoAlpha:1}),h=c,l()};var l=function(){h&&!i?a(".navbar-default").addClass("navbar-stealth"):a(".navbar-default").removeClass("navbar-stealth"),q()};e.contains=function(b){return a.contains(a(".menu3D")[0],b)||a.contains(a(".navbar")[0],b)},e.close=function(){controlMenuState("")},e.openHireMe=function(){controlMenuState("contact")},e.onTouchClick=function(a){if(e.contains(a)){var b=a.className;if(b.indexOf("button-toggle")>-1&&e.on.toggleRenderer.dispatch(),b.indexOf("button-menu")>-1||b.indexOf("menu-icon")>-1||b.indexOf("button-contact"))-1==b.indexOf("about-button")&&controlMenuState(a.id);else{if(b.indexOf("closeMenuPicto")>-1)return;if(b.indexOf("hireMeAbout")>-1)return void controlMenuState("contact");-1==b.indexOf("button-menu")&&-1==b.indexOf("button-contact")&&e.close()}}};var m,n,o,p;e.highlightButtons=function(){m=setTimeout(function(){a(".navbar-stealth .container").addClass("highlightContainer"),a("#moreProjects").addClass("highlight")},1500),o=setTimeout(function(){a(".about-button").addClass("highlight")},3e3),p=setTimeout(q,8e3)};var q=function(){a("#moreProjects").removeClass("highlight"),a(".about-button").removeClass("highlight"),a(".navbar-stealth .container").removeClass("highlightContainer"),clearTimeout(m),clearTimeout(n),clearTimeout(o),clearTimeout(p)};controlMenuState=function(c,h){if(""!=d||""!=c){if("toggleTimeline"==c)return void e.on.toggleTimeline.dispatch();e.resize(),null==h&&(h=.3);var k=0,m=0,n=0,o=200,p=.8;if(d==c){var q=(new Date).getTime()-j;if(500>q)return;k=-f,("contact"==d||"share"==d)&&(m=-LAYOUT.viewportW),d=""}else k="about"==c||""==c?-f:0,"contact"==c||"share"==c?(m=-LAYOUT.viewportW,o=f+g,p=0):""==c?("contact"==d||"share"==d)&&(m=-LAYOUT.viewportW):m=0,n="moreProjects"==c?-150:0,""==d&&b.to(a(".menuContent"),0,{x:m}),d="about"==c?"":c;j=(new Date).getTime(),b.to(a(".menuContent"),h,{x:m,y:n}),!i&&0==k||i&&0!=k?b.to(a(".menu3D"),h,{backgroundColor:"rgba(36,22,37,"+p+")",height:o,y:k}):b.to(a(".menu3D"),h,{backgroundColor:"rgba(36,22,37,"+p+")",height:o}),k==-f?(e.on.close.dispatch(),s(),i=!1):(e.on.open.dispatch(),r(d,h),i=!0),l()}};var r=function(c,d){"contact"==c?(b.to(a(".contact .content"),d,{opacity:1}),a("#contact").addClass("active")):(b.to(a(".contact .content"),d,{opacity:.35}),a("#contact").removeClass("active")),"share"==c?(b.to(a(".share .content"),d,{opacity:1}),a("#share").addClass("active")):(b.to(a(".share .content"),d,{opacity:.35}),a("#share").removeClass("active"))},s=function(){b.to(a(".share .content"),.2,{opacity:.35}),b.to(a(".contact .content"),.2,{opacity:.35}),a("#share").removeClass("active"),a("#contact").removeClass("active")},t=function(){return Math.min(LAYOUT.viewportW,1280)};e.updateState=function(b,c){for(var d=a(".buttonSubMenu"),e=0;e<d.length;e++){var f=a(d[e]);f.attr("folio-id")&&(f.attr("folio-id")==b?f.addClass("active"):f.removeClass("active"))}return"reel"==b?(a("#selectedCases").removeClass("active"),void a(".about-button").removeClass("active")):void(c?(a("#selectedCases").addClass("active"),a(".about-button").removeClass("active")):(a("#selectedCases").removeClass("active"),a(".about-button").addClass("active")))};var u=function(b){var c;"error"==b.type?(c=b.text,a("#error-content").html(c),a(".form-feedback.error").show(),a(".form-feedback.success").hide()):(a(".form-feedback.error").hide(),a(".form-feedback.success").show())},v=function(){var b=a("input[name=email]").val(),c=a("textarea[name=message]").val(),d="Message from Turbodrive Contact form [desktop]",e=!0;if(""==b&&(a("input[name=email]").addClass("field-error"),a("input[name=email]").on("click",removeErrorClasses),e=!1),""==c&&(a("textarea[name=message]").addClass("field-error"),a("textarea[name=message]").on("click",removeErrorClasses),e=!1),e){var f={userEmail:b,userMessage:c,userSubject:d};a.post("php/contact.php",f,u,"json")}};return e.resize=function(){var c=Math.floor((LAYOUT.viewportW-20)/8)-2-10,e=Math.floor((LAYOUT.viewportW-20)/8)-32-8;a(".menuSelectedCases .buttonSubMenu").width(c),a(".menuSelectedCases .buttonSubMenu.backToReel").width(e);var f=t(),g=60*(1-1024/LAYOUT.viewportW),h=10+g,i=20+g,j=70+g,k=.41*f-(i+j),l=.295*f-h;a(".contactPanel").width(f+150),a(".contactPanel").css("left",LAYOUT.viewportW),a(".hireMe").width(k),a(".contact").width(l),a(".share").width(l),a(".contact").css("left",k+i+j),a(".share").css("left",k+l+i+j+h),a(".content").css("padding-left",h),a(".contactPanel .hireMe").css("padding-left",i),a(".contactPanel .hireMe").css("padding-right",j),a(".closeMenu").css("left",k+i+j+2*(h+l)-80),("contact"==d||"share"==d)&&b.set(a(".menuContent"),{x:-LAYOUT.viewportW})},e});